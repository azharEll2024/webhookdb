<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="stylesheet" href="/webterm/index.css" />
  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">
  <title>WebhookDB Interactive Terminal</title>
</head>

<body>
<div id="screen">
  <div id="Container">
    <div id="input">
      <p id="input_title"></p>
      <label id="input-label" for="input_source"></label>
      <input id="input_source" type="command" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
    </div>
    <div id="logger">
      <div id="wrapper">
      </div>
    </div>
  </div>
</div>
<script src="/webterm/vendor/shell-quote.js"></script>
<script src="/webterm/vendor/wasm_exec.js"></script>
<script>
  window.webhookdbRunGo = () => '{}';
  window.webhookdbRun = (env, args) => {
    window.setTimeout(() => {
      window.webhookdbRun(env, args)
    }, 100)
    console.debug('webhookdb.wasm was not loaded, rescheduling an attempt.');
  };
  (async function loadAndRunGoWasm() {
    const go = new Go();
    const response = await fetch("/webterm/webhookdb.wasm");
    const buffer = await response.arrayBuffer();
    const result = await WebAssembly.instantiate(buffer, go.importObject);
    window.webhookdbRun = function(env, args) {
      return new Promise((resolve, reject) => {
        try {
          window.webhookdbRunGo(JSON.stringify(Object.fromEntries(env.entries())), resolve, ...args)
        } catch(e) {
          reject(e)
        }
      })
    }
    await go.run(result.instance)
  })()
</script>
<script src="/webterm/index.js"></script>
</body>
</html>